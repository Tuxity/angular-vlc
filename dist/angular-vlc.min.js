angular.module("kdarcel.vlc-player",[]).constant("VERSION","v1.1.2").run(["$rootScope","VERSION",function(l,n){l.version=n}]).filter("range",function(){return function(l,n){n=parseInt(n);for(var e=0;n>e;e++)l.push(e);return l}}).filter("time2String",function(){return function l(l){if(!l)return"";var n=parseInt(l/1e3%60),e=parseInt(l/6e4%60),t=parseInt(l/36e5%24),c="";return t&&(c+=(10>t?"0"+t:t)+":"),c+=(10>e?"0"+e:e)+":",c+=10>n?"0"+n:n}}).factory("poollingFactory",["$timeout",function(l){function n(t,c){var o=l(t,1e3*e);return o.then(function(){n(t,c)})}var e=1;return{callFnOnInterval:n}}]).directive("vlcplayer",["poollingFactory",function(l){return{restrict:"E",replace:!0,templateUrl:"angular-vlc.tpl.html",link:function(n,e,t){var c=function(l){if(l.url&&l.filename&&(n.vlc=document.getElementById("vlc"),n.vlc)){n.vlc.playlist.items.count>0&&n.vlc.playlist.items.clear();var e=[":vout-filter=deinterlace",":deinterlace-mode=linear"],t=n.vlc.playlist.add(l.url,l.filename,e);"true"==l.autoplay&&n.vlc.playlist.playItem(t),n.vlc.version=n.vlc.versionInfo(),n.vlc.toolbarWidth={width:"640"},n.vlc.toolbarClass="toolbar-vlc",n.vlc.fullscreenClass="vlc-window"}};n.$watch(function(){return n.vlc&&(3==vlc.input.state&&(null===n.videoDuration&&(n.videoDuration=n.vlc.input.length),n.vlc.openning=!1,n.vlc.buffer=!1),7==vlc.input.state&&null===n.vlc.error&&(n.vlc.error=!0),(4==vlc.input.state||5==vlc.input.state||6==vlc.input.state)&&(2==vlc.input.state&&(n.vlc.buffer=!0),1==vlc.input.state&&(n.vlc.openning=!0),n.vlc.toolbar=!0)),{url:t.vlcUrl,filename:t.vlcFilename,autoplay:t.vlcAutoplay}},c,!0),n.vlcKeyEvent=function(l){32==l.keyCode&&n.vlc.playlist.togglePause()},n.vlcToolbarActive=function(l){n.vlc.toolbar=l},n.vlcTogglePause=function(){n.vlc.playlist.togglePause()},n.vlcToggleMute=function(){n.vlc.audio.toggleMute()},n.vlcSwitchAudioTrack=function(l){n.vlc.audio.track=l},n.vlcSwitchSubtitleTrack=function(l){n.vlc.subtitle.track=l},n.changeTime=function(l){var e=document.getElementById("player-progress"),t=(document.getElementById("progress"),Math.floor(l.offsetX/e.offsetWidth*100));vlc.input.time=n.videoDuration*t/100},$(document).on("webkitfullscreenchange mozfullscreenchange fullscreenchange",function(){var l=n.vlc.input.position;n.vlc.playlist.stop(),document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement?(n.vlc.embedFullscreen={width:screen.width,height:screen.height},n.vlc.toolbarWidth={width:screen.width},n.vlc.toolbarClass="toolbar-vlc-fullscreen",n.vlc.fullscreenClass="vlc-fullscreen"):(n.vlc.embedFullscreen={width:"640",height:"360"},n.vlc.toolbarWidth={width:"640"},n.vlc.toolbarClass="toolbar-vlc",n.vlc.fullscreenClass="vlc-window"),n.vlc.playlist.play(),n.vlc.input.position=l}),n.vlcToggleFullscreen=function(){if(document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement)document.cancelFullScreen?document.cancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen();else{var l=document.getElementById("player");l.requestFullscreen?l.requestFullscreen():l.msRequestFullscreen?l.msRequestFullscreen():l.mozRequestFullScreen?l.mozRequestFullScreen():l.webkitRequestFullscreen&&l.webkitRequestFullscreen()}},l.callFnOnInterval(function(){n.vlc&&(n.videoCurrentTime=n.vlc.input.time,n.vlc.timer=n.videoCurrentTime/n.videoDuration*100)})}}}]),function(l){try{l=angular.module("kdarcel.vlc-player.tpl")}catch(n){l=angular.module("kdarcel.vlc-player.tpl",[])}l.run(["$templateCache",function(l){l.put("src/angular-vlc.tpl.html",'<div class="player-container" id="player" ng-keydown="vlcKeyEvent($event);">\n    <div ng-class="{true: \'player-blur-vlc\' }[vlc.buffer == true]" class="{{ vlc.fullscreenClass }}">\n        <object classid="clsid:9BE31822-FDAD-461B-AD51-BE1D1C159921" events="true" width="100%" height="100%" tabindex="0">\n            <embed pluginspage="http://www.videolan.org"\n                   type="application/x-vlc-plugin"\n                   version="VideoLAN.VLCPlugin.2"\n                   allowfullscreen="true"\n                   width="640"\n                   height="360"\n                   toolbar="false"\n                   branding="false"\n                   windowless="true"\n                   id="vlc"\n                   ng-style="vlc.embedFullscreen">\n        </object>\n    </div>\n    <div class="video-controls" ng-mouseover="vlcToolbarActive(true);" ng-mouseleave="vlcToolbarActive(false);">\n        <div class="{{ vlc.toolbarClass }}" ng-class="{true: \'toolbar-active-vlc\', false: \'toolbar-disabled-vlc\'}[vlc.error == true || vlc.toolbar == true]" ng-style="vlc.toolbarWidth">\n            <div class="progress-vlc" id="player-progress" ng-click="changeTime($event)">\n                <div class="progress-bar" id="progress" role="progressbar" aria-valuenow="{{ vlc.timer }}" aria-valuemin="0" aria-valuemax="100" ng-style="{width : ( vlc.timer + \'%\' ) }">\n                </div>\n            </div>\n            <div class="form-inline pull-left">\n                <button type="button" class="btn btn-default btn-default-vlc btn-xs" tooltip="Play/Pause" ng-click="vlcTogglePause()">\n                    <span class="glyphicon" ng-class="vlc.playlist.isPlaying ? \'glyphicon-pause\' : \'glyphicon-play\'"></span>\n                </button>\n                <span class="vlc-text-white">{{ videoCurrentTime | time2String }} / {{ videoDuration | time2String }}</span>\n            </div>\n            <div class="form-inline pull-right">\n                <div class="btn-group dropup" ng-if="vlc.audio.count" dropdown>\n                    <button type="button" class="btn btn-default btn-default-vlc btn-xs dropdown-toggle" tooltip="Audio language" data-toggle="dropdown">\n                        <span class="glyphicon glyphicon-sound-5-1"></span>\n                    </button>\n                    <ul class="dropdown-menu" role="menu">\n                        <li ng-repeat="n in [] | range:vlc.audio.count">\n                            <a href="" ng-click="vlcSwitchAudioTrack(n)">\n                                {{ vlc.audio.description(n) }}&nbsp;<span class="glyphicon glyphicon-ok" ng-show="vlc.audio.track == n"></span>\n                            </a>\n                        </li>\n                    </ul>\n                </div>\n                <div class="btn-group dropup" ng-if="vlc.subtitle.count" dropdown>\n                    <button type="button" class="btn btn-default  btn-default-vlc btn-xs dropdown-toggle" tooltip="Subtitles" data-toggle="dropdown">\n                        <span class="glyphicon glyphicon-subtitles"></span>\n                    </button>\n                    <ul class="dropdown-menu" role="menu">\n                        <li ng-repeat="n in [] | range:vlc.subtitle.count">\n                            <a href="" ng-click="vlcSwitchSubtitleTrack(n)">\n                                {{ vlc.subtitle.description(n) }}&nbsp;<span class="glyphicon glyphicon-ok" ng-show="vlc.subtitle.track == n"></span>\n                            </a>\n                        </li>\n                    </ul>\n                </div>\n                <button type="button" class="btn btn-default btn-default-vlc btn-xs" tooltip="Audio Sounds" ng-click="vlcToggleMute()">\n                    <span class="glyphicon" ng-class="vlc.audio.mute ? \'glyphicon-volume-off\' : \'glyphicon-volume-up\'"></span>\n                </button>\n                <div class="btn-group dropup" dropdown>\n                    <button type="button" class="btn btn-default btn-default-vlc btn-xs dropdown-toggle" tooltip="Parameters">\n                        <span class="glyphicon glyphicon-cog"></span>\n                    </button>\n                    <ul class="dropdown-menu">\n                        <li><a href="https://github.com/Tuxity/angular-vlc/tree/{{ version }}" target="blank"> About angular-vlc </a></li>\n                        <li><a href=""> VLC {{ vlc.version }}</a></li>\n                    </ul>\n                </div>\n                <button type="button" class="btn btn-default btn-default-vlc btn-xs" tooltip="Fullscreen" ng-click="vlcToggleFullscreen()">\n                    <span class="glyphicon glyphicon-resize-full"></span>\n                </button>\n            </div>\n        </div>\n    </div>\n    <div class="error-vlc" ng-if="vlc.error">\n        <p>There is an error with the link your given...</p>\n    </div>\n    <div class="error-vlc" ng-if="vlc.buffer">\n        <p>Video is actually buffering, please wait...</p>\n    </div>\n    <div class="error-vlc" ng-if="vlc.openning">\n        <p>Video will be open in few seconds...</p>\n    </div>\n</div>\n')}])}();